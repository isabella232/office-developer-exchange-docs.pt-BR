---
title: Validar a integridade do backup usando a ferramenta Eseutil no Exchange 2013
manager: sethgros
ms.date: 09/17/2015
ms.audience: Developer
ms.topic: overview
ms.prod: office-online-server
localization_priority: Normal
ms.assetid: b0d325ba-4482-4ca2-9a69-c890f985b206
description: Descubra como usar a ferramenta de linha de comando Eseutil para validar um backup do repositório do Exchange.
ms.openlocfilehash: e8f1a46e2d94729ae5586861317312e277216d63
ms.sourcegitcommit: 88ec988f2bb67c1866d06b361615f3674a24e795
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/03/2020
ms.locfileid: "44452794"
---
#  <a name="validate-backup-integrity-by-using-the-eseutil-tool-in-exchange-2013"></a><span data-ttu-id="6d7c4-103">Validar a integridade do backup usando a ferramenta Eseutil no Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="6d7c4-103">Validate backup integrity by using the Eseutil tool in Exchange 2013</span></span>

<span data-ttu-id="6d7c4-104">Descubra como usar a ferramenta de linha de comando Eseutil para validar um backup do repositório do Exchange.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-104">Find out how to use the Eseutil command-line tool to validate a backup of the Exchange store.</span></span> 
  
<span data-ttu-id="6d7c4-105">**Aplica-se a:** Exchange Server 2013</span><span class="sxs-lookup"><span data-stu-id="6d7c4-105">**Applies to:** Exchange Server 2013</span></span> 
  
<span data-ttu-id="6d7c4-106">Como o serviço de cópias de sombra de volume (VSS) pode criar backups enquanto o Exchange continua a gravar no banco de dados, o servidor não toca em todas as páginas e realiza as verificações de consistência necessárias.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-106">Because the Volume Shadow Copy Service (VSS) can create backups while Exchange continues to write to the database, the server does not touch all the pages and perform the necessary consistency checks.</span></span> <span data-ttu-id="6d7c4-107">Por esse motivo, qualquer aplicativo de backup e restauração que usa o VSS deve verificar a consistência do instantâneo.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-107">For this reason, any backup and restore application that uses VSS must verify snapshot consistency.</span></span> <span data-ttu-id="6d7c4-108">O Exchange Server 2013 suporta os dois métodos a seguir para verificar a consistência do instantâneo:</span><span class="sxs-lookup"><span data-stu-id="6d7c4-108">Exchange Server 2013 supports the following two methods for checking snapshot consistency:</span></span> 
  
- <span data-ttu-id="6d7c4-109">A API CHKSGFILES</span><span class="sxs-lookup"><span data-stu-id="6d7c4-109">The CHKSGFILES API</span></span>
    
- <span data-ttu-id="6d7c4-110">A ferramenta de linha de comando Eseutil</span><span class="sxs-lookup"><span data-stu-id="6d7c4-110">The Eseutil command-line tool</span></span>
    
<span data-ttu-id="6d7c4-111">Recomendamos que você use a API CHKSGFILES, pois é mais fácil para o aplicativo de backup detectar, diagnosticar e relatar erros encontrados durante a verificação de consistência do CHKSGFILES.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-111">We recommend that you use the CHKSGFILES API because it is easier for the backup application to detect, diagnose, and report errors that are found during the CHKSGFILES consistency check.</span></span> <span data-ttu-id="6d7c4-112">Para saber mais sobre como usar a API do CHKSGFILES, confira [validar integridade do backup usando a API do CHKSGFILES no Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span><span class="sxs-lookup"><span data-stu-id="6d7c4-112">For information about how to use the CHKSGFILES API, see [Validate backup integrity by using the CHKSGFILES API in Exchange 2013](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md).</span></span>
  
## <a name="running-the-eseutil-tool"></a><span data-ttu-id="6d7c4-113">Executando a ferramenta Eseutil</span><span class="sxs-lookup"><span data-stu-id="6d7c4-113">Running the Eseutil tool</span></span>

<span data-ttu-id="6d7c4-114">Para verificar a consistência do instantâneo, execute o comando Eseutil em relação aos arquivos de log e banco de dados identificados na tabela a seguir.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-114">To check the snapshot consistency, run the eseutil command against the database and log files that are identified in the following table.</span></span> 
  
<span data-ttu-id="6d7c4-115">**Tabela 1. Comandos Eseutil. exe para cada tipo de backup**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-115">**Table 1. Eseutil.exe commands for each backup type**</span></span>

|<span data-ttu-id="6d7c4-116">**Tipo de arquivo/tipo de backup**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-116">**File type/backup type**</span></span>|<span data-ttu-id="6d7c4-117">**Backup completo**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-117">**Full backup**</span></span>|<span data-ttu-id="6d7c4-118">**Copiar backup**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-118">**Copy backup**</span></span>|<span data-ttu-id="6d7c4-119">**Backup incremental**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-119">**Incremental backup**</span></span>|<span data-ttu-id="6d7c4-120">**Backup diferencial**</span><span class="sxs-lookup"><span data-stu-id="6d7c4-120">**Differential backup**</span></span>|
|:-----|:-----|:-----|:-----|:-----|
|<span data-ttu-id="6d7c4-121">. edb</span><span class="sxs-lookup"><span data-stu-id="6d7c4-121">.edb</span></span>  <br/> |<span data-ttu-id="6d7c4-122">"Eseutil/k/i"</span><span class="sxs-lookup"><span data-stu-id="6d7c4-122">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="6d7c4-123">"Eseutil/k/i"</span><span class="sxs-lookup"><span data-stu-id="6d7c4-123">"eseutil /k /i"</span></span>  <br/> |<span data-ttu-id="6d7c4-124">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="6d7c4-124">Not applicable</span></span>  <br/> |<span data-ttu-id="6d7c4-125">Não aplicável</span><span class="sxs-lookup"><span data-stu-id="6d7c4-125">Not applicable</span></span>  <br/> |
|<span data-ttu-id="6d7c4-126">. log</span><span class="sxs-lookup"><span data-stu-id="6d7c4-126">.log</span></span>  <br/> |<span data-ttu-id="6d7c4-127">"Eseutil/k" (1)</span><span class="sxs-lookup"><span data-stu-id="6d7c4-127">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="6d7c4-128">"Eseutil/k" (1)</span><span class="sxs-lookup"><span data-stu-id="6d7c4-128">"eseutil /k" (1)</span></span>  <br/> |<span data-ttu-id="6d7c4-129">"Eseutil/k" (2)</span><span class="sxs-lookup"><span data-stu-id="6d7c4-129">"eseutil /k" (2)</span></span>  <br/> |<span data-ttu-id="6d7c4-130">"Eseutil/k" (2)</span><span class="sxs-lookup"><span data-stu-id="6d7c4-130">"eseutil /k" (2)</span></span>  <br/> |
   
> [!NOTE]
> <span data-ttu-id="6d7c4-131">Não é necessário executar o comando Eseutil em arquivos. stm e. chk.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-131">You do not need to run the eseutil command against .stm and .chk files.</span></span> 
  
<span data-ttu-id="6d7c4-132">Todos os arquivos de log que têm um número de geração de arquivo de log igual ou maior que o número de geração do arquivo de log de ponto de verificação são necessários para recuperar um banco de dados de instantâneo.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-132">All the log files that have a log file generation number that is equal to or greater than the generation number of the checkpoint log file are required in order to recover a snapshot database.</span></span> <span data-ttu-id="6d7c4-133">Se ele existir, o arquivo de log atual (Enn. log) também será necessário para a recuperação de banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-133">If it exists, the current log file (Enn.log) is also required for database recovery.</span></span> <span data-ttu-id="6d7c4-134">Se algum dos arquivos de log necessários falhar na verificação de consistência, o solicitante deverá garantir que o status do componente de backup seja definido como FALSE antes de chamar o método [BackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) .</span><span class="sxs-lookup"><span data-stu-id="6d7c4-134">If any of the required log files fail the consistency check, the requester must make sure that the status of the backup component is set to FALSE before it calls the [BackupComplete](https://msdn.microsoft.com/library/windows/desktop/aa382651%28v=vs.85%29.aspx) method.</span></span> <span data-ttu-id="6d7c4-135">Para identificar o arquivo de log de ponto de verificação, execute o Eseutil. exe em relação ao arquivo de verificação de instantâneo e analise a saída de "ponto de verificação:".</span><span class="sxs-lookup"><span data-stu-id="6d7c4-135">To identify the checkpoint log file, run Eseutil.exe against the snapshot checkpoint file and parse the output for "Checkpoint:."</span></span> <span data-ttu-id="6d7c4-136">O exemplo a seguir mostra como executar o Eseutil. exe em um arquivo de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-136">The following example shows how to run Eseutil.exe against a checkpoint file.</span></span> 
  
```cpp
c:\eseutil.exe /mk E01.chk
Checkpoint: (0x20, 9D, 187)
```

<span data-ttu-id="6d7c4-137">A segunda linha no exemplo é o valor de retorno, onde 0x20 é o número de geração de log hexadecimal do arquivo de log de ponto de verificação.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-137">The second line in the example is the return value, where 0x20 is the hexadecimal log generation number of the checkpoint log file.</span></span> <span data-ttu-id="6d7c4-138">Neste exemplo, qualquer arquivo de log, incluindo E01000020. log e superior, não deve estar corrompido para recuperar o banco de dados de instantâneo, mesmo que o banco de dados em si já tenha passado a verificação de consistência física.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-138">In this example, any log files, including E01000020.log and greater, must not be corrupt in order to recover the snapshot database, even if the database itself has already passed the physical consistency check.</span></span>
  
<span data-ttu-id="6d7c4-139">Todos os arquivos de log em um conjunto de backup incremental ou diferencial são necessários para a recuperação do banco de dados.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-139">All log files in an incremental or differential backup set are required for database recovery.</span></span> <span data-ttu-id="6d7c4-140">Você pode verificar a consistência de uma sequência de log executando o Eseutil. exe em relação ao prefixo do arquivo de log.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-140">You can check the consistency of a log sequence by running Eseutil.exe against the log file prefix.</span></span> <span data-ttu-id="6d7c4-141">O exemplo a seguir mostra como executar verificações de consistência em todos os arquivos do formato E01xxxxx. log em um determinado caminho.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-141">The following example shows how to run consistency checks against all the files of the form E01xxxxx.log on a given path.</span></span>
  
```cpp
c:\eseutil /k E01
```

## <a name="checking-the-eseutilexe-output"></a><span data-ttu-id="6d7c4-142">Verificação da saída de Eseutil. exe</span><span class="sxs-lookup"><span data-stu-id="6d7c4-142">Checking the Eseutil.exe output</span></span>

<span data-ttu-id="6d7c4-143">O solicitante deve verificar se todos os valores de erro de Exit ERRORLEVEL retornados não são negativos.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-143">The requester must verify that all the exit ERRORLEVEL error values that are returned are nonnegative.</span></span> <span data-ttu-id="6d7c4-144">Para obter informações sobre valores ERRORLEVEL, confira [referência para erros comuns de Eseutil](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx).</span><span class="sxs-lookup"><span data-stu-id="6d7c4-144">For information about ERRORLEVEL values, see [Reference for Common Eseutil Errors](https://technet.microsoft.com/library/aa996759%28v=exchg.80%29.aspx).</span></span> <span data-ttu-id="6d7c4-145">Para ver o ERRORLEVEL na linha de comando, digite "Echo% ERRORLEVEL%" após o Eseutil. exe terminar a execução.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-145">To see the ERRORLEVEL at the command line, type "echo %errorlevel%" after Eseutil.exe finishes running.</span></span> <span data-ttu-id="6d7c4-146">Um ERRORLEVEL negativo indica que um ou mais arquivos estão corrompidos.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-146">A negative ERRORLEVEL indicates that one or more files is corrupted.</span></span>
  
<span data-ttu-id="6d7c4-147">Antes de o solicitante chamar o método **BackupComplete** , ele deve garantir que o status do componente de backup reflita o resultado da verificação de consistência.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-147">Before the requester calls the **BackupComplete** method, it must make sure that the status of the backup component reflects the result of the consistency check.</span></span> <span data-ttu-id="6d7c4-148">Se alguma corrupção for encontrada, o status será FALSE; Se nenhuma corrupção for encontrada, o status será TRUE.</span><span class="sxs-lookup"><span data-stu-id="6d7c4-148">If any corruption was found, the status will be FALSE; if no corruption was found, the status will be TRUE.</span></span> 
  
## <a name="see-also"></a><span data-ttu-id="6d7c4-149">Confira também</span><span class="sxs-lookup"><span data-stu-id="6d7c4-149">See also</span></span>

- [<span data-ttu-id="6d7c4-150">Validar a integridade do backup usando a API CHKSGFILES no Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="6d7c4-150">Validate backup integrity by using the CHKSGFILES API in Exchange 2013</span></span>](how-to-validate-backup-integrity-by-using-the-chksgfiles-api-in-exchange.md)
- [<span data-ttu-id="6d7c4-151">Criar aplicativos de backup e restauração para o Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="6d7c4-151">Build backup and restore applications for Exchange 2013</span></span>](build-backup-and-restore-applications-for-exchange-2013.md)
- [<span data-ttu-id="6d7c4-152">Referência de classe função cchksgfiles</span><span class="sxs-lookup"><span data-stu-id="6d7c4-152">CChkSGFiles class reference</span></span>](cchksgfiles-class-reference.md)
- [<span data-ttu-id="6d7c4-153">Conceitos de backup e restauração para o Exchange 2013</span><span class="sxs-lookup"><span data-stu-id="6d7c4-153">Backup and restore concepts for Exchange 2013</span></span>](backup-and-restore-concepts-for-exchange-2013.md)
    

