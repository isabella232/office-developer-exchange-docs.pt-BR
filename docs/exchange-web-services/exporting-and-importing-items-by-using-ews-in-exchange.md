---
title: Exportando e importando itens usando o EWS no Exchange
manager: sethgros
ms.date: 03/9/2015
ms.audience: Developer
localization_priority: Normal
ms.assetid: ad5f75f9-47c3-4f51-a535-80cba4243683
description: Saiba mais sobre a exportação e importação de compromissos, emails, contatos, tarefas e outros itens de caixa de correio usando a API gerenciada de EWS ou EWS no Exchange.
ms.openlocfilehash: 63ba8807dd63ca2d151b1c2b1277625daeed640c
ms.sourcegitcommit: 34041125dc8c5f993b21cebfc4f8b72f0fd2cb6f
ms.translationtype: MT
ms.contentlocale: pt-BR
ms.lasthandoff: 06/25/2018
ms.locfileid: "19750677"
---
# <a name="exporting-and-importing-items-by-using-ews-in-exchange"></a>Exportando e importando itens usando o EWS no Exchange

Saiba mais sobre a exportação e importação de compromissos, emails, contatos, tarefas e outros itens de caixa de correio usando a API gerenciada de EWS ou EWS no Exchange. 
  
O Exchange é uma mina de ouro de informações importantes: email, contatos, tarefas e calendários são centrais para funções de uma organização. EWS permite exportar e importar os tipos de item de núcleo via três abordagens diferentes:
  
- Tipos de item do Exchange. Recomendamos essa abordagem para importar e exportar itens de e para outros sistemas e arquivos.
    
- Recurso de nível de item (EWS). É recomendável essa opção para exportar ou copiar de um do Exchange server ou caixa de correio e importando para outro.
    
- Fluxos MIME na forma de formatos de arquivo padrão comuns, como iCalendar e vCard. Como o conjunto de propriedades é limitado e conversão de MIME é dispendiosa, recomendamos a abordagem somente para importar ou exportar uma pequena quantidade de dados.
    
> [!IMPORTANT]
> EWS não foi projetado para caixa de correio backup e restauração. Para fazer backup e restaurar bancos de dados, use a [API de backup e restauração](../backup-restore/backup-and-restore-for-exchange-2013.md). Consulte também [recuperação de desastres, Backup e restauração,](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx) no TechNet. 
  
**Tabela 1. Exportando e importando o contato, email e itens de calendário**

|**Task**|**Método API gerenciada de EWS**|**Operação do EWS**|**Notes**|
|:-----|:-----|:-----|:-----|
|Exporta uma cópia de um contato, email, tarefa ou item de calendário com um [conjunto de propriedades especificado](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> [Task.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.bind%28v=exchg.80%29.aspx) <br/> |[GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) <br/> |É recomendável essa opção se estiver exportando itens de caixa de correio para outro sistema não são do Exchange ou do arquivo (incluindo vCard e tipos de arquivo iCal). Como você terá controle sobre o conjunto de propriedades exportado, e o desempenho é melhor para o Exchange server, isso geralmente é a melhor opção.  <br/> Dependendo das propriedades definido em um item de caixa de correio e se o aplicativo está ciente todos os identificadores de propriedade não esquematizado (propriedades estendidas) que podem ser definidos em um item, essa opção não produzirá uma cópia com total fidelidade.  <br/> Esses métodos e operação fornecem o esquematizado conjunto de propriedades para um item, além de quaisquer propriedades estendidas solicitadas. O método **vincular** ou a operação **GetItem** só pode fornecer exportação de fidelidade total de itens se você souber as propriedades estendidas definidas em um item. Você pode solicitar todas as conhecidas [propriedades estendidas](properties-and-extended-properties-in-ews-in-exchange.md) para habilitar com fidelidade total.  <br/> > [!TIP]> Você pode usar o recurso de rastreamento na API gerenciada do EWS para obter a representação XML do itens exportados.           Para obter mais informações, consulte [Exportar um item em um formato personalizado](how-to-export-items-by-using-ews-in-exchange.md#bk_exportcustom).  <br/> |
|Importe uma cópia de um contato, email, tarefa ou item de calendário com um [conjunto de propriedades especificado](properties-and-extended-properties-in-ews-in-exchange.md).  <br/> |[Contact.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.save%28v=exchg.80%29.aspx) <br/> [EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> [Task.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.task.save%28v=exchg.80%29.aspx) <br/> |[CreateItem](http://msdn.microsoft.com/library/78a52120-f1d0-4ed7-8748-436e554f75b6%28Office.15%29.aspx) <br/> |Recomendamos que esta opção para importar itens de caixa de correio para o Exchange. Você pode precisar definir propriedades especiais em alguns tipos de item para manter o estado do item importado. Porque algumas propriedades são definidas apenas pelo Exchange e não por clientes, ele nem sempre é possível ter uma importação com total fidelidade.  <br/> Por exemplo, você não pode importar uma reunião com participantes em uma caixa de correio porque Exchange define as relações entre o organizador e participantes. Esse relacionamento só pode ser estabelecido pelo organizadores enviando e recebendo e responder à solicitação de reunião de participantes.  <br/> Objetos de **compromisso** no Exchange podem ter configurações e relações complexas. Compromissos que possuem participantes (reuniões) têm configurações que unem o organizador da reunião e os participantes da reunião. Essas configurações não serão mantidas quando você exportar e importar compromissos. Os compromissos programaticamente restabelecendo relações do organizador/attendee diretamente diante da reunião não é suportado. Uma opção que você precisa para restabelecendo é realizar essas relações, pós-processamento após uma importação, ter um organizador reenviar as reuniões e fazer com que os participantes aceite as reuniões. Você pode usar a representação do Exchange para fazer chamadas para o organizador e os participantes. Você deve alterar a propriedade UID do objeto **compromisso** antes de importar para evitar ter reuniões incorretamente estar relacionado a outras reuniões em uma caixa de correio.  <br/> |
|Exporta uma cópia de um contato, email, tarefa ou item de calendário em com total fidelidade.  <br/> |Não aplicável  <br/> |[ExportItems](http://msdn.microsoft.com/library/e2846abb-0b16-4732-bbd8-038a674672f6%28Office.15%29.aspx) <br/> |Esta é a melhor opção para exportação de itens de caixa de correio que você deseja importar de volta para uma caixa de correio do Exchange. Você também pode usar essa opção para copiar os itens entre caixas de correio. A operação **ExportItems** fornece um fluxo de opaco que representa o item que você pode usar para mover informações entre caixas de correio. Você pode usar **ExportItems** com a operação [GetItem](http://msdn.microsoft.com/library/e3590b8b-c2a7-4dad-a014-6360197b68e4%28Office.15%29.aspx) para tornar um índice para localizar os itens em outro sistema. Você não pode alterar o fluxo de exportação.  <br/> Para obter mais informações, consulte [exportar itens com fidelidade total](how-to-export-items-by-using-ews-in-exchange.md#bk_exportfullfidelity).  <br/> |
|Importe uma cópia de um contato, email, tarefa ou item de calendário em com total fidelidade.  <br/> |Não aplicável  <br/> |[UploadItems](http://msdn.microsoft.com/library/a88cbe99-7968-454d-a545-4f92c330909f%28Office.15%29.aspx) <br/> |Esta é a única opção de importação de itens que foram exportados pela operação de **ExportItems** .  <br/> |
|Exporta uma cópia de um contato, email ou item de calendário como um fluxo MIME para um tipo de arquivo comuns.  <br/> |[Contact.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.contact.bind%28v=exchg.80%29.aspx) <br/> [EmailMessage.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.bind%28v=exchg.80%29.aspx) <br/> [Appointment.Bind](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.bind%28v=exchg.80%29.aspx) <br/> |**GetItem** <br/> |Você pode usar a propriedade [MimeContent](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.item.mimecontent%28v=exchg.80%29.aspx) para obter a representação de fluxo MIME de um item.  <br/> Isso fornecerá um subconjunto básico de todas as propriedades em um item. Como prática recomendada, use somente o fluxo MIME para operações únicas. Não confie nas MIME para grande e frequente importar/exportar de itens, porque o Exchange realiza a conversão de conteúdo para o MIME e isso pode afetar o desempenho.  <br/> O fluxo MIME de **contato** é um arquivo [vCard](http://www.faqs.org/rfcs/rfc2426.mdl) (. vcf). Dependendo das propriedades definidas em um contato, isso não produzirá uma cópia com total fidelidade. Observe que você não pode importar um contato usando o fluxo MIME vCard. Para saber mais, consulte [Exportar um contato em um arquivo vCard](how-to-export-items-by-using-ews-in-exchange.md#bk_exportvcardmime).  <br/> O fluxo MIME **EmailMessage** é um arquivo. eml. O formato. eml é conveniente, porque o Outlook e outros clientes de email podem identificá-lo. Você também pode usar o fluxo MIME para criar um arquivo. mht, que é conveniente porque muitos navegadores podem usar esse tipo de arquivo. EWS não fornece um fluxo de arquivo. msg para exportar um email para um arquivo. msg. Suas opções para exportar um arquivo. msg são de qualquer construção de [um. Arquivo MSG](http://msdn.microsoft.com/en-us/library/cc463912%28v=EXCHG.80%29.aspx) dos resultados de uma operação de **GetItem** ou o método **EmailMessage.Bind** telefonar ou usar uma API de terceiros que chama o EWS e constrói dos resultados de um arquivo. msg. Para obter mais informações, consulte [Exportar um email como um arquivo. eml](how-to-export-items-by-using-ews-in-exchange.md#bk_exportemailmime).  <br/> O fluxo MIME de **compromisso** é um arquivo de iCalendar (. ICS). O formato. ICS é conveniente, porque o Outlook e outros clientes de email podem identificá-lo. Isso não é uma opção viável para a exportação de reuniões porque as informações do participante não for fornecidas no fluxo de MIME. Anexos e outras propriedades não podem ser incluídas no fluxo de MIME. Considere construindo formato iCal do objeto [compromisso](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment%28v=exchg.80%29.aspx) ou o XML retornado pela operação de **GetItem** . Dessa forma, você pode capturar mais das propriedades do Exchange com as propriedades estendidas ("X-' Propriedades) no arquivo iCalendar. Você também pode exportar um compromisso no formato XML. Chamar a operação **GetItem** e salve o XML no seu sistema. Você também pode usar a [funcionalidade de rastreamento](how-to-trace-requests-responses-to-troubleshoot-ews-managed-api-applications.md) na API gerenciada do EWS para capturar o XML a ser colocado em um banco de dados XML. Para obter mais informações, consulte [Exportando um compromisso como um arquivo iCal](how-to-export-items-by-using-ews-in-exchange.md#bk_exporticalmime).  <br/> |
|Importe uma cópia de um item de email ou calendário como um fluxo MIME para um tipo de arquivo comuns.  <br/> |[EmailMessage.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.emailmessage.save%28v=exchg.80%29.aspx) <br/> [Appointment.Save](http://msdn.microsoft.com/en-us/library/microsoft.exchange.webservices.data.appointment.save%28v=exchg.80%29.aspx) <br/> |**CreateItem** <br/> |Você pode importar um arquivo. eml ou. ICS usando a propriedade **MimeContent** em um objeto **EmailMessage** ou um **compromisso** . Você precisará definir o [PidTagMessageFlags (0x0E07)](http://msdn.microsoft.com/en-us/library/office/cc839733%28v=office.15%29.aspx) a propriedade estendida se o email não é um rascunho.  <br/> Você não pode usar essa abordagem para importar reuniões.  <br/> |
   
## <a name="alternatives-to-exporting-and-importing-items-by-using-ews"></a>Alternativas para exportar e importar itens usando o EWS
<a name="alternatives"> </a>

Outras opções estão disponíveis para exporing e importar itens para e de uma caixa de correio do Exchange. A seguir estão algumas ideias a serem consideradas quando você projetar a importação e exportação estratégia:
  
- Use o PowerShell para chamar o EWS e formatar a saída em um arquivo. csv.
    
- Use bibliotecas de terceiros que implementam o MAPI para exportar e importar itens. Bibliotecas de terceiros que convertem EWS em arquivos. msg também estão disponíveis.
    
- Use os cmdlets do Shell de gerenciamento do Exchange e [MailboxImportRequest](http://technet.microsoft.com/en-us/library/ff607310%28v=exchg.150%29.aspx) e [MailboxExportRequest](http://technet.microsoft.com/en-us/library/ff607299%28v=exchg.150%29.aspx) para [atender a importação de caixa de correio e solicitações de exportação](http://technet.microsoft.com/en-us/library/ee633455%28v=exchg.150%29.aspx). 
    
- Use as [Opções de importação do Outlook](http://office.microsoft.com/en-us/outlook-help/import-outlook-items-from-an-outlook-data-file-pst-HA102505743.aspx) para importar e exportar itens. 
    
## <a name="in-this-section"></a>Nesta seção
<a name="alternatives"> </a>

- [Exportar itens usando o EWS no Exchange](how-to-export-items-by-using-ews-in-exchange.md)
    
- [Importar itens usando o EWS no Exchange](how-to-import-items-by-using-ews-in-exchange.md)
    
## <a name="see-also"></a>Confira também


- [Backup, restauração e recuperação de desastres](http://technet.microsoft.com/en-us/library/dd876874%28v=exchg.150%29.aspx)
    
- [Registro no diário](http://technet.microsoft.com/en-us/library/aa998649%28v=exchg.150%29.aspx)
    
- [Calendário da Internet e agendamento de especificação de objeto de núcleo (RFC 5545)](http://tools.ietf.org/html/rfc5545)
    
- [Sincronização de caixa de correio e EWS no Exchange](mailbox-synchronization-and-ews-in-exchange.md)
    

